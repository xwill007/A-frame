<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entorno Principal VR - English Learning</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="../vr-formulario-registro/vr-formulario-registro.js"></script>
    <script src="../vr-formulario-login/vr-formulario-login.js"></script>
    <script src="../vr-lista-canciones/vr-lista-canciones.js"></script>
</head>
<body>
<!-- Escena VR Principal del Entorno de Aprendizaje -->
<a-scene background="color: #ECECEC" vr-mode-ui="enabled: true">
    <!-- Cielo con nubes -->
    <a-sky src="../imagenes/cielo.jpg" rotation="0 -90 0"></a-sky>
    
    <!-- Plano de piso -->
    <a-circle position="0 0 0" rotation="-90 0 0" radius="20" segments="64"
              material="src: ../imagenes/pasto.jpg; repeat: 2 3"></a-circle>

    <!-- Árboles alrededor del escenario -->
    <a-entity id="trees">
        <!-- Árbol 1 -->
        <a-entity position="-5 0.5 -5">
            <a-cylinder height="2" radius="0.2" color="#8B4513"></a-cylinder>
            <a-cone height="3" radius-bottom="1" color="#228B22" position="0 1.5 0"></a-cone>
        </a-entity>
        <!-- Árbol 2 -->
        <a-entity position="5 0.5 -5">
            <a-cylinder height="2" radius="0.2" color="#8B4513"></a-cylinder>
            <a-cone height="3" radius-bottom="1" color="#228B22" position="0 1.5 0"></a-cone>
        </a-entity>
        <!-- Árbol 3 -->
        <a-entity position="0 0.5 -10">
            <a-cylinder height="2" radius="0.2" color="#8B4513"></a-cylinder>
            <a-cone height="3" radius-bottom="1" color="#228B22" position="0 1.5 0"></a-cone>
        </a-entity>
    </a-entity>

    <!-- Cubo interactivo con selector de color -->
    <a-box id="colorBox"
        position="-3.5 1.0 2.0" 
        rotation="0 0 0" 
        scale="1 1 1"
        color="rgba(255,0,13,0.8)"
        animation="property: rotation; to: 0 360 0; loop: true; dur: 10000"
        class="clickable">
        
        <!-- Modelo 3D: casco Helmet -->
        <a-entity
            position="0 1.0 0"
            scale="0.6 0.6 0.6"
            gltf-model="https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/DamagedHelmet/glTF-Binary/DamagedHelmet.glb">
        </a-entity>
    </a-box>
    
    <!-- Modelo 3D animado: Fox -->
    <a-entity
        position="4 0 1"
        scale="0.01 0.01 0.01"
        animation-mixer
        gltf-model="https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/Fox/glTF-Binary/Fox.glb">
    </a-entity>
    
    <!-- Panel de navegación principal -->
    <a-entity id="navigation-panel" position="0 2 -3">
        <!-- Imagen de inicio (clickeable) -->
        <a-image id="inicio-btn" 
                 src="../imagenes/inicio.png" 
                 position="0 0 0" 
                 width="2" 
                 height="2"
                 class="clickable navigation-btn"
                 animation="property: scale; startEvents: mouseenter; to: 1.1 1.1 1.1; dur: 200"
                 animation__reset="property: scale; startEvents: mouseleave; to: 1 1 1; dur: 200">
        </a-image>

        <!-- Imagen karaoke (clickeable) -->
        <a-image id="karaoke-btn" 
                 src="../imagenes/karaoke.png" 
                 position="-4 0 0" 
                 width="2" 
                 height="2"
                 class="clickable navigation-btn"
                 animation="property: scale; startEvents: mouseenter; to: 1.1 1.1 1.1; dur: 200"
                 animation__reset="property: scale; startEvents: mouseleave; to: 1 1 1; dur: 200">
        </a-image>
    </a-entity>

    <!-- Componentes VR Interactivos -->
    
    <!-- Componente VR de formulario de registro -->
    <a-entity 
        id="registro-vr-component" 
        formulario-registro-vr="formPosition: 0 3.5 -1.5; buttonPosition: 0 1.5 3; visible: false">
    </a-entity>

    <!-- Componente VR de formulario de login -->
    <a-entity 
        id="login-vr-component" 
        formulario-login-vr="formPosition: -3.0 3.5 1.5; buttonPosition: -3 1.5 3; visible: false">
    </a-entity>

    <!-- Componente VR de lista de canciones -->
    <a-entity 
        id="canciones-vr-component" 
        lista-canciones-vr="listPosition: 0 2.5 -3; buttonPosition: 4 1.5 3; visible: false">
    </a-entity>
    
    <!-- Iluminación mejorada -->
    <a-entity light="type: ambient; color: #BBB; intensity: 0.8"></a-entity>
    <a-entity light="type: directional; position: 0 1 1; intensity: 0.8"></a-entity>
    <a-entity light="type: point; position: 2 2 2; intensity: 0.5"></a-entity>
    
    <!-- Cámara con controles VR -->
    <a-entity id="rig" position="0 1.6 5">
        <a-entity camera 
                  look-controls="pointerLockEnabled: true" 
                  wasd-controls="acceleration: 20">
            <a-cursor 
                position="0 0 -1"
                geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                material="color: white; shader: flat"
                animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
                animation__fuse="property: scale; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
                raycaster="objects: .clickable">
            </a-cursor>
        </a-entity>
        
        <!-- Controladores VR -->
        <a-entity id="leftHand" 
                  hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc"
                  laser-controls="hand: left"
                  raycaster="objects: .clickable">
        </a-entity>
        
        <a-entity id="rightHand" 
                  hand-controls="hand: right; handModelStyle: lowPoly; color: #ccffcc"
                  laser-controls="hand: right"
                  raycaster="objects: .clickable">
        </a-entity>
    </a-entity>

</a-scene>

<script src="entorno-principal.js"></script>
</body>
</html>
